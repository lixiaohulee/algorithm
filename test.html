<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
    </style>
</head>
<body>

    <img src="./test.png">
    <canvas width="300" height="300" style="background: red;">your browser can not support canvas</canvas>
    <script>

        window.onload = function() {
            const drawing = document.getElementsByTagName('canvas')[0]

            if (drawing.getContext) {
                const context = drawing.getContext('2d')

                const img = document.querySelector('img')

                context.drawImage(img,0,0)
                
                const imageData = context.getImageData(0, 0, img.width, img.height)
                const dat = imageData.data


                for(let i = 0; i <= data.length; i+=4) {
                    const red = data[i]
                    const green = data[i+1]
                    const blue = data[i+2]
                    const alpha = data[i+3]

                    const aver = Math.floor((red + green + blue) / 3)
                    
                    data[i] = aver
                    data[i+1] = aver
                    data[i+2] = aver
                    
                }

                imageData.data = data
                context.putImageData(imageData, 0, 0)


                // const pattern = context.createPattern(img, 'repeat')

                // const gradient = context.createLinearGradient(30, 30, 70, 70)

                // gradient.addColorStop(0, 'white')
                // gradient.addColorStop(1, 'red')

                // context.fillStyle = pattern

                // context.fillRect(0, 0, 200, 200)

            }
        }
    </script>
</body>
</html>